<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Usulan/Masukan/Saran/Pendapat - Pra Pertemuan Pekerja Gereja ke-4 Tahun 2025</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
  * { box-sizing: border-box; font-family: 'Poppins', sans-serif; }
  body {
    margin: 0;
    color: #222;
    background: linear-gradient(120deg, #fff5f5, #f5fff7, #fdf6ff);
    background-size: 400% 400%;
    animation: bgShift 20s ease infinite;
  }
  @keyframes bgShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* === HEADER GRADIENT === */
  header {
    position: relative;
    color: white;
    text-align: center;
    padding: 2.5rem 1rem;
    overflow: hidden;
    background: linear-gradient(270deg, #800000, #ffcc00, #009900, #663399, #ff6699, #000000);
    background-size: 1000% 1000%;
    animation: gradientFlow 30s ease infinite;
  }
  @keyframes gradientFlow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* === LOGO GKE GLOW === */
  header::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 160px;
    height: 160px;
    background: url('https://upload.wikimedia.org/wikipedia/commons/2/2e/LOGO_GKE.png') no-repeat center/contain;
    opacity: 0.1;
    transform: translate(-50%, -50%);
    animation: pulseGlow 8s ease-in-out infinite alternate;
  }
  @keyframes pulseGlow {
    0% { filter: drop-shadow(0 0 5px rgba(255,255,255,0.5)); }
    100% { filter: drop-shadow(0 0 25px rgba(255,255,255,1)); }
  }

  header h1, header h2 {
    margin: .5rem 0;
    position: relative;
    z-index: 2;
    text-shadow: 0 0 10px rgba(255,255,255,0.9);
  }

  header h1 { font-size: 1.7rem; font-weight: 600; }
  header h2 { font-size: 1.1rem; font-weight: 400; }

  /* === FORM === */
  form {
    background: rgba(255,255,255,0.9);
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    width: 90%; max-width: 780px;
    padding: 2rem; margin: 2rem auto;
  }

  label { display: flex; flex-direction: column; margin-bottom: 1rem; font-weight: 500; }
  input, select {
    margin-top: .4rem; padding: .7rem;
    border: 1px solid #ccc;
    border-radius: 10px;
    font-size: 1rem; background: #fff;
    transition: 0.2s;
  }
  input:focus, select:focus {
    outline: none;
    border-color: #800000;
    box-shadow: 0 0 5px #80000055;
  }

  fieldset { border: none; margin-top: 1rem; }
  legend { font-weight: 600; margin-bottom: .5rem; color: #800000; }
  .grid { display: grid; gap: .7rem; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }

  .actions { display: flex; justify-content: center; gap: 1rem; margin-top: 1.5rem; }

  button {
    border: none;
    padding: .9rem 1.6rem;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 600;
    color: #fff;
    background: linear-gradient(90deg, #009900, #ffcc00, #800000);
    background-size: 200% 200%;
    animation: btnGradient 8s ease infinite;
    transition: 0.3s;
  }
  @keyframes btnGradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  button:hover { transform: scale(1.05); box-shadow: 0 0 10px #ffcc00; }

  /* === TABEL REKAP === */
  section {
    width: 90%;
    max-width: 900px;
    background: rgba(255,255,255,0.9);
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    padding: 1.5rem;
    margin: 0 auto 2rem;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    color: #222;
    font-size: 0.95rem;
    margin-top: 1rem;
  }
  th, td {
    padding: 10px 8px;
    border: 1px solid #ddd;
    text-align: left;
  }
  th { background: #ffcc00; color: #222; }
  tr:nth-child(even) { background: #fff8f0; }

  footer {
    background: linear-gradient(90deg, #009900, #663399, #ff6699, #800000);
    background-size: 600% 600%;
    animation: footerAnim 20s ease infinite;
    color: white;
    text-align: center;
    padding: 1rem;
    font-size: 0.9rem;
  }
  @keyframes footerAnim {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* === RESPONSIVE === */
  @media (max-width: 768px) {
    body { font-size: 0.95rem; padding-bottom: 2rem; }

    header { padding: 1.8rem 1rem; }
    header h1 {
      font-size: clamp(1rem, 5vw, 1.4rem);
      line-height: 1.3;
    }
    header h2 {
      font-size: clamp(0.85rem, 3.5vw, 1rem);
    }

    form, section { width: 95%; padding: 1.2rem; }

    label { font-size: 0.9rem; }
    input, select { font-size: 0.9rem; padding: 0.6rem; }

    .actions { flex-direction: column; gap: 0.8rem; }
    button { width: 100%; font-size: 0.95rem; }

    th, td { font-size: 0.85rem; padding: 5px; }
    table { min-width: 600px; }

    footer { font-size: 0.8rem; padding: 0.8rem; }
  }

  @media (max-width: 400px) {
    header h1 { font-size: 1.1rem; }
    header h2 { font-size: 0.8rem; }
    form, section { padding: 1rem; }
    input, select { font-size: 0.85rem; }
  }
</style>
</head>

<body>

<header>
  <h1>üïäÔ∏è Usulan, Masukan & Pendapat</h1>
  <h2>Pra Pertemuan Pekerja Gereja ke-4 Tahun 2025</h2>
  <h2>Jemaat GKE Yerusalem Tamiang Layang</h2>
</header>

<form id="usulanForm">
  <label>Tanggal
    <input type="date" name="tanggal" required>
  </label>

  <label>Kelompok Pekerja Gereja
    <select name="kelompok" required>
      <option value="">-- Pilih Kelompok --</option>
      <option>Pendeta/Vicaris</option>
      <option>BPP</option>
      <option>Pengurus Lingkungan Sion</option>
      <option>Pengurus Lingkungan Betlehem</option>
      <option>Pengurus Lingkungan Betania</option>
      <option>Pengurus Lingkungan Siloam</option>
      <option>Seksi Pelayanan Anak</option>
      <option>Seksi Pelayanan Remaja dan Pemuda</option>
      <option>Seksi Pelayanan Perempuan</option>
      <option>Seksi Pelayanan Bapak</option>
      <option>Seksi Pelayanan Lansia</option>
      <option>Operator LCD</option>
      <option>Organis/Pemain Musik</option>
      <option>Song Leaders</option>
      <option>Tim Musik</option>
      <option>Tim Multimedia</option>
      <option>Koster Gereja Efata</option>
      <option>Koster Gereja Maranatha</option>
      <option>Panitia Pembangunan Gereja Efata</option>
      <option>Panitia Pembangunan Gereja Maranatha</option>
      <option>Panitia Tanah Pemakaman</option>
    </select>
  </label>

  <label>Nama Pengisi
    <input type="text" name="nama" placeholder="Nama lengkap" required>
  </label>

  <fieldset>
    <legend>Usulan/Masukan/Saran/Pendapat</legend>
    <div class="grid" id="gridUsulan"></div>
  </fieldset>

  <div class="actions">
    <button type="submit">Kirim Usulan</button>
    <button type="reset" class="secondary">Reset</button>
  </div>
</form>

<section>
  <h2 style="text-align:center;">üìä Rekap Usulan yang Masuk</h2>
  <div style="overflow-x:auto;">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Tanggal</th>
          <th>Kelompok</th>
          <th>Nama Pengisi</th>
          <th style="text-align:center;">Jumlah Usulan</th>
        </tr>
      </thead>
      <tbody id="rekapBody"></tbody>
    </table>
  </div>
  <p id="statusMsg" style="text-align:center;margin-top:1rem;font-size:.85rem;opacity:.9;">
    ‚è≥ Memuat data...
  </p>
</section>

<footer>&copy; <span id="year"></span> MPHJ GKE Yerusalem Tamiang Layang</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSHCQ_5BGfWSTnGY3Si0DOMP9MIrmhtJT7I8N0pvuR3T8IZ_sL9kCwiV0qAbJZRf2EGiIr33W9QVMsT/pub?gid=0&single=true&output=csv";
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxZvPS36yi1Mi_CKfm05I5t4jcoNtbm2AJCNoj3Za6jndFz_s8KMVpRQLGMoHeiFE7Z/exec";
  const tableBody = document.getElementById("rekapBody");
  const statusMsg = document.getElementById("statusMsg");
  document.getElementById("year").textContent = new Date().getFullYear();

  const grid = document.getElementById("gridUsulan");
  for (let i = 1; i <= 10; i++) {
    const lbl = document.createElement("label");
    lbl.innerHTML = `Usulan ${i}<input type='text' name='usulan${i}' placeholder='Masukkan usulan ke-${i}' />`;
    grid.appendChild(lbl);
  }

  function formatTanggal(tgl) {
    if (!tgl || !/^\d{4}-\d{2}-\d{2}$/.test(tgl)) return tgl;
    const [y, m, d] = tgl.split("-");
    const bulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
    return `${d} ${bulan[parseInt(m)-1]} ${y}`;
  }

  document.getElementById("usulanForm").addEventListener("submit", async e => {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(e.target).entries());
    try {
      await fetch(SCRIPT_URL, { method: "POST", mode: "no-cors", body: JSON.stringify(data) });
      alert("‚úÖ Usulan berhasil dikirim. Terima kasih!");
      e.target.reset();
      loadData();
    } catch (err) {
      alert("‚ùå Gagal mengirim, periksa koneksi.");
    }
  });

  async function loadData() {
    try {
      tableBody.innerHTML = "";
      const res = await fetch(SHEET_CSV_URL + "&t=" + Date.now());
      const text = (await res.text()).replace(/^\uFEFF/, "");
      const rows = text.trim().split(/\r?\n/).map(r => r.split(","));
      if (rows.length <= 1) {
        statusMsg.textContent = "‚ö†Ô∏è Tidak ada data.";
        return;
      }
      rows.slice(1).forEach((cols, i) => {
        const id = cols[0] || i + 1;
        const tanggal = formatTanggal(cols[1]);
        const kelompok = cols[2] || "-";
        const nama = cols[3] || "-";
        const jumlah = cols.slice(4, 14).filter(x => x && x.trim() !== "").length;
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${id}</td><td>${tanggal}</td><td>${kelompok}</td><td>${nama}</td><td style="text-align:center;">${jumlah}</td>`;
        tableBody.appendChild(tr);
      });
      statusMsg.textContent = "‚úÖ Data berhasil dimuat dari Google Sheet.";
    } catch {
      statusMsg.textContent = "‚ö†Ô∏è Gagal memuat data.";
    }
  }
  loadData();
});
</script>
</body>
</html>
