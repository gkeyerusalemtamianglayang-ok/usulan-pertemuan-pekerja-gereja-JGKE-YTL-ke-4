<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Usulan Pra Pertemuan Pekerja GKE</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --shadow: rgba(0,0,0,0.25);
  }
  *{box-sizing:border-box;}
  body{
    margin:0; color:#fff; font-family:'Poppins',sans-serif;
    min-height:100vh; display:flex; flex-direction:column; align-items:center;
    overflow-x:hidden;
    background:#000;
  }

  /* === AURORA MULTI-LAYER DYNAMIC === */
  .aurora, .aurora::before, .aurora::after {
    content:"";
    position:fixed;
    inset:-50%;
    z-index:-3;
    pointer-events:none;
    background:linear-gradient(270deg,
      #ff0000,
      #ffa500,
      #ffff00,
      #00ff00,
      #00ffff,
      #0000ff,
      #8a2be2,
      #ff00ff,
      #ff0000);
    background-size:800% 800%;
    mix-blend-mode:screen;
    filter:blur(140px);
    opacity:0.5;
    animation:flow1 40s ease-in-out infinite alternate, hue 60s linear infinite;
  }
  .aurora::before {
    animation:flow2 55s ease-in-out infinite alternate, hue 70s linear infinite reverse;
    opacity:.35;
  }
  .aurora::after {
    animation:flow3 70s ease-in-out infinite alternate, hue 80s linear infinite;
    opacity:.3;
  }

  @keyframes hue {
    from { filter:hue-rotate(0deg) blur(140px); }
    to { filter:hue-rotate(360deg) blur(140px); }
  }
  @keyframes flow1 {
    0%{transform:translate(-10%,-10%) scale(1);}
    50%{transform:translate(8%,6%) scale(1.05);}
    100%{transform:translate(-6%,10%) scale(1.1);}
  }
  @keyframes flow2 {
    0%{transform:translate(10%,5%) rotate(10deg) scale(1.05);}
    100%{transform:translate(-8%,-5%) rotate(-10deg) scale(1.1);}
  }
  @keyframes flow3 {
    0%{transform:translate(-5%,10%) rotate(-15deg) scale(1);}
    100%{transform:translate(5%,-10%) rotate(15deg) scale(1.08);}
  }

  /* === LOGO BACKGROUND === */
  .logo-bg {
    position: fixed;
    inset: 0;
    background: url('https://upload.wikimedia.org/wikipedia/commons/2/2e/LOGO_GKE.png')
      center/contain no-repeat;
    mix-blend-mode: soft-light;
    opacity: 0.15;
    z-index: -1;
  }

  /* === HEADER === */
  header{text-align:center;margin-top:2rem;}
  header img{width:85px;border-radius:50%;box-shadow:0 0 10px #ffffff33;}
  h1{margin:.6rem 0 0;font-size:1.7rem;font-weight:600;}
  header p{margin:.2rem 0 1.5rem;color:#e2ffff;}

  /* === FORM === */
  form{
    background:rgba(255,255,255,0.12);
    backdrop-filter:blur(12px);
    border-radius:20px;
    box-shadow:0 8px 25px var(--shadow);
    width:90%; max-width:780px; padding:2rem; margin-bottom:3rem;
  }
  label{display:flex;flex-direction:column;margin-bottom:1rem;font-weight:500;}
  input,select{
    margin-top:.4rem;padding:.7rem;border:none;border-radius:10px;
    font-size:1rem;background:rgba(255,255,255,0.95);color:#333;
  }
  fieldset{border:none;margin-top:1rem;}
  legend{font-weight:600;margin-bottom:.5rem;}
  .grid{display:grid;gap:.7rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));}
  .actions{display:flex;justify-content:center;gap:1rem;margin-top:1.5rem;}

  button{
    border:none;padding:.9rem 1.6rem;border-radius:12px;
    cursor:pointer;font-weight:600;color:#fff;
    background:linear-gradient(270deg,#ff0000,#ff8000,#ffff00,#00ff00,#00ffff,#0000ff,#8a2be2,#ff00ff,#ff0000);
    background-size:600% 600%;
    animation:btnAurora 10s linear infinite;
  }
  @keyframes btnAurora {
    0%{background-position:0% 50%;}
    50%{background-position:100% 50%;}
    100%{background-position:0% 50%;}
  }
  button:hover{transform:scale(1.05);}
  footer{text-align:center;margin-top:auto;padding:1rem;color:#f0faff;opacity:.9;}
</style>
</head>

<body>
<div class="aurora"></div>
<div class="logo-bg"></div>

<header>
  <img src="https://upload.wikimedia.org/wikipedia/commons/2/2e/LOGO_GKE.png" alt="Logo GKE">
  <h1>Usulan Pra Pertemuan Pekerja Gereja ke-4 Tahun 2025</h1>
  <p>Jemaat GKE Yerusalem Tamiang Layang</p>
</header>

<form id="usulanForm">
  <label>Tanggal
    <input type="date" name="tanggal" required>
  </label>

  <label>Kelompok Pekerja Gereja
    <select name="kelompok" required>
      <option value="">-- Pilih Kelompok --</option>
      <option>Pendeta/Vicaris</option>
      <option>BPP</option>
      <option>Pengurus Lingkungan Sion</option>
      <option>Pengurus Lingkungan Betlehem</option>
      <option>Pengurus Lingkungan Betania</option>
      <option>Pengurus Lingkungan Siloam</option>
      <option>Seksi Pelayanan Anak</option>
      <option>Seksi Pelayanan Remaja dan Pemuda</option>
      <option>Seksi Pelayanan Perempuan</option>
      <option>Seksi Pelayanan Bapak</option>
      <option>Seksi Pelayanan Lansia</option>
      <option>Operator LCD</option>
      <option>Organis/Pemain Musik</option>
      <option>Song Leaders</option>
      <option>Tim Musik</option>
      <option>Tim Multimedia</option>
      <option>Koster Gereja Efata</option>
      <option>Koster Gereja Maranatha</option>
      <option>Panitia Pembangunan dan Pemeliharaan Gereja Efata</option>
      <option>Panitia Pembangunan dan Pemeliharaan Gereja Maranatha</option>
      <option>Panitia Pengadaan dan Pemeliharaan Tanah Pemakaman</option>
    </select>
  </label>

  <label>Nama Pengisi
    <input type="text" name="nama" placeholder="Nama lengkap" required>
  </label>

  <fieldset>
    <legend>Usulan / Pendapat / Masukan</legend>
    <div class="grid" id="gridUsulan"></div>
  </fieldset>

  <div class="actions">
    <button type="submit">Kirim Usulan</button>
    <button type="reset" class="secondary">Reset</button>
  </div>
</form>
<section style="width:90%;max-width:900px;background:rgba(255,255,255,0.08);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 4px 20px rgba(0,0,0,.25);padding:1.5rem;margin-bottom:2rem;">
  <h2 style="text-align:center;margin-bottom:1rem;">üìä Rekap Usulan yang Masuk</h2>
  <div style="overflow-x:auto;">
    <table style="width:100%;border-collapse:collapse;color:#fff;">
      <thead>
        <tr style="background:rgba(255,255,255,0.2);">
          <th style="padding:8px 4px;">ID</th>
          <th style="padding:8px 4px;">Tanggal</th>
          <th style="padding:8px 4px;">Kelompok Pekerja</th>
          <th style="padding:8px 4px;">Nama Pengisi</th>
          <th style="padding:8px 4px;">Jumlah Usulan</th>
        </tr>
      </thead>
      <tbody id="rekapBody"></tbody>
    </table>
  </div>
  <p style="text-align:center;margin-top:1rem;font-size:.85rem;opacity:.8;">
    *Data diperbarui otomatis dari Google Sheet "usulan"
  </p>
</section>

<footer>&copy; <span id="year"></span> MPHJ GKE Yerusalem Tamiang Layang</footer>

<script>
  // generate 10 input usulan otomatis
  const grid = document.getElementById('gridUsulan');
  for(let i=1;i<=10;i++){
    const lbl=document.createElement('label');
    lbl.innerHTML=`Usulan ${i}<input type='text' name='usulan${i}' />`;
    grid.appendChild(lbl);
  }
  document.getElementById('year').textContent=new Date().getFullYear();

  // URL Apps Script kamu
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxZvPS36yi1Mi_CKfm05I5t4jcoNtbm2AJCNoj3Za6jndFz_s8KMVpRQLGMoHeiFE7Z/exec";

  document.getElementById('usulanForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const data=Object.fromEntries(new FormData(e.target).entries());
    try{
      await fetch(SCRIPT_URL,{method:'POST',mode:'no-cors',body:JSON.stringify(data)});
      alert('‚úÖ Usulan berhasil dikirim. Terima kasih!');
      e.target.reset();
    }catch(err){
      alert('‚ùå Gagal mengirim, periksa koneksi.');
      console.error(err);
    }
  });
</script>
  <script>
const SHEET_JSON_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vSHCQ_5BGfWSTnGY3Si0DOMP9MIrmhtJT7I8N0pvuR3T8IZ_sL9kCwiV0qAbJZRf2EGiIr33W9QVMsT/gviz/tq?tqx=out:json&sheet=usulan";

const tableBody = document.getElementById("rekapBody");
const statusMsg = document.getElementById("statusMsg");
const reloadBtn = document.getElementById("reloadBtn");

// fungsi muat data
async function loadData() {
  tableBody.style.opacity = 0.3;
  statusMsg.textContent = "‚è≥ Memuat data...";
  try {
    const res = await fetch(SHEET_JSON_URL + "&t=" + new Date().getTime()); // biar gak cache
    const text = await res.text();
    // hilangkan pembungkus JSON khas Google
    const json = JSON.parse(text.substring(47).replace(/\);$/, ""));
    const rows = json.table.rows;

    tableBody.innerHTML = "";

    rows.forEach((r, i) => {
      // ambil setiap sel
      const c = r.c.map(x => (x ? x.v : ""));
      // kalau baris kosong, skip
      if (!c[0]) return;

      const id = c[0];
      const tanggal = c[1];
      const kelompok = c[2];
      const nama = c[3];
      const usulans = c.slice(4, 14); // kolom Usulan 1‚Äì10
      const jumlahUsulan = usulans.filter(x => x && x.trim() !== "").length;

      // bikin baris tabel
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${id}</td>
        <td>${tanggal}</td>
        <td>${kelompok}</td>
        <td>${nama}</td>
        <td style="text-align:center">${jumlahUsulan}</td>
      `;
      tableBody.appendChild(tr);
    });

    tableBody.style.opacity = 1;
    statusMsg.textContent = "‚úÖ Data berhasil dimuat dari Google Sheet";
  } catch (err) {
    console.error("Gagal memuat data:", err);
    statusMsg.textContent = "‚ö†Ô∏è Gagal memuat data, coba lagi.";
  }
}

reloadBtn.addEventListener("click", loadData);
loadData();
</script>


</body>
</html>
